<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giao Diá»‡n GiÃ¡o ViÃªn - Táº¡o Äá» Thi (Firebase)</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Firebase Config Section -->
        <div id="firebaseConfigSection" class="card">
            <h1>âš™ï¸ Cáº¥u HÃ¬nh Firebase</h1>
            <p class="hint">Nháº­p thÃ´ng tin Firebase Ä‘á»ƒ káº¿t ná»‘i database (chá»‰ cáº§n lÃ m 1 láº§n)</p>
            
            <div class="form-group">
                <label>API Key:</label>
                <input type="text" id="apiKey" placeholder="AIzaSy..." class="input-field">
            </div>
            
            <div class="form-group">
                <label>Auth Domain:</label>
                <input type="text" id="authDomain" placeholder="your-project.firebaseapp.com" class="input-field">
            </div>
            
            <div class="form-group">
                <label>Project ID:</label>
                <input type="text" id="projectId" placeholder="your-project-id" class="input-field">
            </div>
            
            <div class="form-group">
                <label>Database URL:</label>
                <input type="text" id="databaseURL" placeholder="https://your-project.firebaseio.com" class="input-field">
            </div>
            
            <button onclick="saveFirebaseConfig()" class="btn btn-primary">LÆ°u Cáº¥u HÃ¬nh & Káº¿t Ná»‘i</button>
            <button onclick="skipFirebase()" class="btn btn-secondary">Bá» Qua (DÃ¹ng LocalStorage)</button>
            
            <div class="info-box" style="margin-top: 20px;">
                <h3>ğŸ“– HÆ°á»›ng dáº«n táº¡o Firebase:</h3>
                <ol style="padding-left: 20px; color: #555;">
                    <li>Truy cáº­p: <a href="https://console.firebase.google.com" target="_blank">Firebase Console</a></li>
                    <li>Táº¡o project má»›i</li>
                    <li>VÃ o "Realtime Database" > Create Database > Start in test mode</li>
                    <li>VÃ o Project Settings > General > Scroll xuá»‘ng "Your apps"</li>
                    <li>Copy Firebase configuration vÃ  dÃ¡n vÃ o form trÃªn</li>
                </ol>
            </div>
        </div>

        <!-- Login Form -->
        <div id="loginSection" class="card hidden">
            <h1>ÄÄƒng Nháº­p GiÃ¡o ViÃªn</h1>
            <div id="connectionStatus" class="status-badge"></div>
            <input type="text" id="teacherName" placeholder="Nháº­p tÃªn giÃ¡o viÃªn" class="input-field">
            <button onclick="teacherLogin()" class="btn btn-primary">ÄÄƒng Nháº­p</button>
            <p class="hint">TÃªn máº·c Ä‘á»‹nh: ***</p>
            <button onclick="reconfigFirebase()" class="btn btn-secondary" style="margin-top: 10px;">Cáº¥u hÃ¬nh láº¡i Firebase</button>
        </div>

        <!-- Create Exam Section -->
        <div id="createExamSection" class="card hidden">
            <div class="header">
                <h1>Táº¡o Äá» Thi</h1>
                <div>
                    <span id="onlineIndicator" class="online-badge">ğŸŸ¢ Online</span>
                    <button onclick="logout()" class="btn btn-secondary">ÄÄƒng Xuáº¥t</button>
                </div>
            </div>

            <div class="form-group">
                <label>TÃªn Äá» Thi:</label>
                <input type="text" id="examTitle" placeholder="VÃ­ dá»¥: Kiá»ƒm tra toÃ¡n há»c lá»›p 10" class="input-field">
            </div>

            <div class="form-group">
                <label>Thá»i Gian LÃ m BÃ i (phÃºt):</label>
                <input type="number" id="examDuration" value="30" min="1" class="input-field">
            </div>

            <div class="form-group">
                <label>MÃ£ LaTeX Äá» Thi:</label>
                <textarea id="latexInput" class="textarea-field" rows="10" placeholder="Nháº­p mÃ£ LaTeX theo Ä‘á»‹nh dáº¡ng:

\question CÃ¢u há»i 1?
\choice ÄÃ¡p Ã¡n A
\choice ÄÃ¡p Ã¡n B
\choice ÄÃ¡p Ã¡n C
\CorrectChoice ÄÃ¡p Ã¡n D

\question CÃ¢u há»i 2?
\choice ÄÃ¡p Ã¡n A
\CorrectChoice ÄÃ¡p Ã¡n B
\choice ÄÃ¡p Ã¡n C
\choice ÄÃ¡p Ã¡n D"></textarea>
            </div>

            <button onclick="parseLatex()" class="btn btn-primary">Xem TrÆ°á»›c Äá» Thi</button>

            <!-- Preview Section -->
            <div id="previewSection" class="hidden">
                <h2>Xem TrÆ°á»›c Äá» Thi</h2>
                <div id="questionsPreview" class="preview-box"></div>
                
                <button onclick="saveExam()" class="btn btn-success">LÆ°u Äá» Thi & Táº¡o MÃ£</button>
            </div>

            <!-- Exam Code Display -->
            <div id="examCodeSection" class="hidden">
                <h2>MÃ£ Äá» Thi ÄÃ£ Táº¡o</h2>
                <div class="code-display">
                    <p>MÃ£ cho há»c sinh: <strong id="examCode"></strong></p>
                    <button onclick="copyCode()" class="btn btn-secondary">Copy MÃ£</button>
                </div>
                <p class="hint">Link há»c sinh: <a id="studentLink" href="#" target="_blank"></a></p>
            </div>

            <!-- Active Exams List -->
            <div id="activeExamsSection">
                <h2>CÃ¡c Äá» Thi Äang Hoáº¡t Äá»™ng</h2>
                <div id="activeExamsList" class="preview-box"></div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection">
                <h2>Káº¿t Quáº£ Thi (Realtime)</h2>
                <div class="results-actions">
                    <button onclick="downloadExcel()" class="btn btn-success">ğŸ“¥ Táº£i Excel</button>
                    <button onclick="clearAllResults()" class="btn btn-danger">ğŸ—‘ï¸ XÃ³a Táº¥t Cáº£ Káº¿t Quáº£</button>
                    <button onclick="refreshResults()" class="btn btn-secondary">ğŸ”„ LÃ m Má»›i</button>
                </div>
                <div id="resultsList" class="results-box"></div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="teacher-firebase.js"></script>
</body>
</html>
